basePath: /api
definitions:
  config.AppConfig:
    properties:
      alist:
        properties:
          host:
            type: string
          password:
            type: string
          username:
            type: string
        type: object
      api_key:
        description: 独立的 API Key 字段
        type: string
      db_conn:
        type: string
      db_type:
        type: string
      default_points:
        description: 默认积分配置
        type: integer
      password:
        type: string
      port:
        type: integer
      username:
        type: string
    type: object
  gorm.DeletedAt:
    properties:
      time:
        type: string
      valid:
        description: Valid is true if Time is not NULL
        type: boolean
    type: object
  handlers.APIKeyResponse:
    properties:
      api_key:
        type: string
    type: object
  handlers.ConfigStatus:
    properties:
      exists:
        type: boolean
      redirect:
        type: string
    type: object
  models.PointConfig:
    properties:
      createdAt:
        type: string
      deletedAt:
        $ref: '#/definitions/gorm.DeletedAt'
      description:
        description: 积分描述
        type: string
      fileUrl:
        description: 文件路径
        type: string
      id:
        type: integer
      points:
        description: 积分值
        type: integer
      updatedAt:
        type: string
    type: object
info:
  contact: {}
  description: 提供用户积分管理、积分配置和积分日志查询等功能
  title: 积分管理系统API
  version: "1.0"
paths:
  /admin:
    get:
      description: 返回管理后台页面的 HTML 内容，需管理员身份验证
      produces:
      - text/html
      responses:
        "200":
          description: 管理后台页面 HTML
          schema:
            type: string
        "401":
          description: 未授权访问
          schema:
            type: string
        "500":
          description: 管理后台页面不存在或读取失败
          schema:
            type: string
      summary: 获取管理后台页面
      tags:
      - 配置管理
  /adminGrantPoints:
    post:
      consumes:
      - application/json
      description: |-
        管理员给用户增加或减少积分
        获取当前登录用户的信息和积分
      parameters:
      - description: 积分操作信息
        in: body
        name: data
        required: true
        schema:
          additionalProperties: true
          type: object
      produces:
      - application/json
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 获取用户信息
      tags:
      - 用户管理
      - 用户管理
  /api/checkConfig:
    get:
      description: 检查 config.json 是否存在，返回存在状态和跳转路径
      produces:
      - application/json
      responses:
        "200":
          description: 配置状态
          schema:
            $ref: '#/definitions/handlers.ConfigStatus'
      summary: 检查配置文件是否存在
      tags:
      - 配置管理
  /api/getApiKey:
    get:
      description: 获取当前配置文件中的 API Key，仅管理员可见
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.APIKeyResponse'
      summary: 获取当前 API Key
      tags:
      - 配置管理
  /api/saveConfig:
    post:
      consumes:
      - application/json
      description: 保存系统配置到 config.json，仅允许首次设置
      parameters:
      - description: 系统配置信息
        in: body
        name: config
        required: true
        schema:
          $ref: '#/definitions/config.AppConfig'
      produces:
      - application/json
      responses:
        "200":
          description: 保存成功
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: 解析请求体失败
          schema:
            type: string
        "403":
          description: 配置文件已存在，不允许修改
          schema:
            type: string
        "405":
          description: 无效的请求方法
          schema:
            type: string
        "500":
          description: 保存配置文件失败
          schema:
            type: string
      summary: 保存系统配置
      tags:
      - 配置管理
  /config.html:
    get:
      description: 返回系统配置页面的 HTML 内容
      produces:
      - text/html
      responses:
        "200":
          description: 配置页面 HTML
          schema:
            type: string
        "500":
          description: 配置页面加载失败
          schema:
            type: string
      summary: 获取配置页面
      tags:
      - 配置管理
  /configurePoints:
    post:
      consumes:
      - application/json
      description: 为文件设置积分值
      parameters:
      - description: 积分配置信息
        in: body
        name: config
        required: true
        schema:
          $ref: '#/definitions/models.PointConfig'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 配置文件积分
      tags:
      - 积分配置
  /downloadFile:
    post:
      consumes:
      - application/json
      description: 扣除用户积分并返回文件下载地址
      parameters:
      - description: 文件信息
        in: body
        name: data
        required: true
        schema:
          additionalProperties:
            type: string
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 下载文件
      tags:
      - 文件下载
  /generateApiKey:
    post:
      consumes:
      - application/json
      description: 管理员生成新的 API Key 并保存到配置文件，返回生成的 API Key
      produces:
      - application/json
      responses:
        "200":
          description: 生成成功，返回新的 API Key
          schema:
            $ref: '#/definitions/handlers.APIKeyResponse'
        "405":
          description: 无效的请求方法
          schema:
            type: string
        "500":
          description: 保存API Key失败
          schema:
            type: string
        "503":
          description: 管理员账号未配置
          schema:
            type: string
      summary: 生成新的 API Key
      tags:
      - 配置管理
  /getFileInfo:
    get:
      description: 获取文件名称和所需积分
      parameters:
      - description: 文件URL
        in: query
        name: fileUrl
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 获取文件信息
      tags:
      - 文件下载
  /getPointsList:
    get:
      description: 获取所有文件的积分配置
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 获取积分配置列表
      tags:
      - 积分配置
  /getPointsLog:
    get:
      description: 获取用户积分变更历史记录
      parameters:
      - description: 用户名（可选）
        in: query
        name: username
        type: string
      - description: 返回记录数量限制（默认50）
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 获取积分变更日志
      tags:
      - 积分日志
  /getUserInfo:
    get:
      consumes:
      - application/json
      description: |-
        管理员给用户增加或减少积分
        获取当前登录用户的信息和积分
      parameters:
      - description: 积分操作信息
        in: body
        name: data
        required: true
        schema:
          additionalProperties: true
          type: object
      produces:
      - application/json
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 获取用户信息
      tags:
      - 用户管理
      - 用户管理
  /getUserPoints:
    get:
      description: 获取指定用户的积分信息
      parameters:
      - description: 用户名
        in: query
        name: username
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 获取用户积分
      tags:
      - 用户积分
  /getUsersList:
    get:
      description: 获取所有用户及其积分信息
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 获取用户列表
      tags:
      - 用户管理
swagger: "2.0"
